<!DOCTYPE html>
<html>
  <head>
    <title>Exemplo de página web com vídeo</title>
    <style>
      body {
        margin: 0;
        padding: 0;
      }

      .div {
        width: 100vw;
        height: 50vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .video-container {
        width: 100%;
        height: 100%;
        position: relative;
      }

      video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      #qr-canvas {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        z-index: 1;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="div">
      <div class="video-container">
        <video id="myVideo" autoplay muted loop>
          <source
            src="https://youtu.be/6ISYNFHejPw"
            type="video/mp4"
          />
        </video>
      </div>
    </div>

    <canvas id="qr-canvas"></canvas>

    <script src="https://rawgit.com/sitepoint-editors/jsqrcode/master/src/qr_packed.js"></script>
    <script>
      var video = document.getElementById("myVideo");
      var lastScannedCode = null;
      var canvas = document.getElementById("qr-canvas");
      var context = canvas.getContext("2d");
      var stopStream = function (stream) {
        stream.getTracks().forEach(function (track) {
          track.stop();
        });
      };

      function detectQRCode() {
        navigator.mediaDevices
          .getUserMedia({ video: { facingMode: "environment" } })
          .then(function (stream) {
            video.srcObject = stream;
            video.setAttribute("playsinline", true);
            video.play();
            setTimeout(() => {
              canvas.width = video.videoWidth;
              canvas.height = video.videoHeight;
              context.drawImage(video, 0, 0, canvas.width, canvas.height);
              try {
                qrcode.decode();
              } catch (e) {
                setTimeout(detectQRCode, 500);
              }
            }, 1000);
          })
          .catch(function (err) {
            console.log("Error: " + err);
          });

        qrcode.callback = function (data) {
          if (data !== lastScannedCode) {
            lastScannedCode = data;
            if (data) {
              console.log("QR Code detected: " + data);
            }
          }
          setTimeout(detectQRCode, 500);
        };
      }

      detectQRCode();
    </script>
  </body>
</html>
